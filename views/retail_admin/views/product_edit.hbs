<!DOCTYPE html>

<html lang="en" class="default-style layout-fixed layout-navbar-fixed">

<head>
    <title>Catalog | title</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description"
        content="Empire Bootstrap admin template made using Bootstrap 4, it has tons of ready made feature, UI components, pages which completely fulfills any dashboard needs." />
    <meta name="keywords"
        content="Empire, bootstrap admin template, bootstrap admin panel, bootstrap 4 admin template, admin template">
    <meta name="author" content="Srthemesvilla" />
    <link rel="icon" type="image/x-icon" href="">

    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">

    <!-- Icon fonts -->
    <link rel="stylesheet" href="/assets/fonts/fontawesome.css">
    <link rel="stylesheet" href="/assets/fonts/ionicons.css">
    <link rel="stylesheet" href="/assets/fonts/linearicons.css">
    <link rel="stylesheet" href="/assets/fonts/open-iconic.css">
    <link rel="stylesheet" href="/assets/fonts/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="/assets/fonts/feather.css">

    <!-- Core stylesheets -->
    <link rel="stylesheet" href="/assets/css/bootstrap-material.css">
    <link rel="stylesheet" href="/assets/css/shreerang-material.css">
    <link rel="stylesheet" href="/assets/css/uikit.css">

    <!-- Libs -->
    <link rel="stylesheet" href="/assets/libs/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="/assets/libs/flot/flot.css">
    <link rel="stylesheet" href="/assets/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css">
    <link rel="stylesheet" href="/assets/libs/datatables/datatables.css">
    <link rel="stylesheet" href="/assets/libs/dropzone/dropzone.css">
    <link rel="stylesheet" href="/assets/libs/bootstrap-select/bootstrap-select.css">
    <link rel="stylesheet" href="/assets/libs/bootstrap-multiselect/bootstrap-multiselect.css">
    <link rel="stylesheet" href="/assets/libs/select2/select2.css">
    <link rel="stylesheet" href="/assets/libs/bootstrap-tagsinput/bootstrap-tagsinput.css">
    <link rel="stylesheet" href="/assets/libs/growl/growl.css">
    {{!--
    <script src="https://cdn.ckeditor.com/4.12.1/standard/ckeditor.js"></script> --}}
    {{!--
    <script src="https://cdn.ckeditor.com/36.0.0/standard/ckeditor.js"></script> --}}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ckeditor/4.9.2/ckeditor.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>

<body>
    <!-- [ Preloader ] Start -->
    <div class="page-loader">
        <div class="bg-primary"></div>
    </div>
    <!-- [ Preloader ] End -->

    <!-- [ Layout wrapper ] Start -->
    <div class="layout-wrapper layout-2">
        <div class="layout-inner">
            <!-- [ Layout sidenav ] Start -->
            {{>admin/sidebar}}
            <!-- [ Layout sidenav ] End -->
            <!-- [ Layout container ] Start -->
            <div class="layout-container">
                <!-- [ Layout navbar ( Header ) ] Start -->
                {{>admin/header}}
                <!-- [ Layout navbar ( Header ) ] End -->

                <!-- [ Layout content ] Start -->
                <div class="layout-content">

                    <!-- [ content ] Start -->
                    <div class="container-fluid flex-grow-1 container-p-y">
                        <h4 class="font-weight-bold py-3 mb-0">Edit Catalog</h4>
                        <div class="text-muted small mt-0 mb-4 d-block breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/index"><i class="feather icon-home"></i></a></li>
                                <li class="breadcrumb-item ">Catalog</li>
                                <li class="breadcrumb-item active">Edit Catalog</li>
                            </ol>
                        </div>
                        <form action="/product_edit/{{sql_product._id}}" method="POST" enctype="multipart/form-data">

                            <div class="row">
                                <div class="col-md-10">
                                    <div class="card mb-4" style="">
                                        <h6 class="card-header">Edit Catalog</h6>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label class="form-label">Select Categories</label>
                                                <select class="select2-demo form-control" multiple style="width: 100%"
                                                    id="selected_cat" name="selected_cat[]" onchange="subcat_get()"
                                                    autofocus>
                                                    {{#each category}}
                                                    {{!-- <p>Category ID: {{this._id}}</p>
                                                    <p>Type IDs: {{../typeIds}}</p> --}}
                                                    <option value="{{this._id}}" {{#includes ../typeIds this._id}}
                                                        selected {{/includes}}>
                                                        {{this.category_name}}</option>
                                                    {{/each}}
                                                    {{!-- (in_array(this._id, typeIds, true)) --}}
                                                    {{!-- this._id.indexOf(typeIds) --}}
                                                    {{!-- ;(eq this._id ../typeIds) --}}
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Select Subcategories</label>
                                                <select class="select2-demo form-control" multiple style="width: 100%"
                                                    id="get_subcat" name="selected_subcat[]">
                                                    <option value=""></option>
                                                </select>
                                            </div>

                                            <!--<button type="button" class="btn btn-info" onclick="add_products()">Add More Product</button>-->

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="products" class="row">
                                <div class="col-md-10">
                                    <div class="card mb-4" style="">
                                        <h6 class="card-header">Edit Product</h6>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label class="form-label col-md-4">
                                                    <input type="radio" name="product_type" value="Ready to Ship" {{#if
                                                        (eq sql_product.product_type 'Ready to Ship' )}}Checked{{/if}}>
                                                    Ready to Ship
                                                </label>
                                                <label class="form-label col-md-4">
                                                    <input type="radio" name="product_type" value="Upcoming" {{#if (eq
                                                        sql_product.product_type 'Upcoming' )}}Checked{{/if}}> Upcoming
                                                </label>
                                                <label class="form-group col-md-4">
                                                    <input type="radio" name="product_type1" value="On Booking" {{#if
                                                        (eq sql_product.product_type 'On Booking' )}}Checked{{/if}}> On
                                                    Booking
                                                </label>
                                                <label class="form-label col-md-4">
                                                    <input type="radio" name="product_type" value="Ask Availibility"
                                                        {{#if (eq sql_product.product_type 'Ask Availibility'
                                                        )}}Checked{{/if}}>
                                                    Ask Availibility
                                                </label>
                                                <label class="form-label col-md-4">
                                                    <input type="radio" name="product_type" {{#if (eq
                                                        sql_product.product_type '' )}}Checked{{/if}}> None
                                                </label>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label col-md-12">
                                                    <input type="checkbox" id="upcoming_checkbox1"
                                                        name="upcoming_checkbox" {{#if (eq sql_product.upcoming '1' )}}
                                                        checked {{/if}}> Featured/Hot Products
                                                </label>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Select Image</label>
                                                <input type="file" name="image_file" accept="image/*"
                                                    class="form-control" onchange="readURL(this);" id="image_file1">
                                                <img id="blah" src="http://localhost:4000/{{sql_product.product_image}}"
                                                    style="max-width:150px;max-height:150px;margin: auto;padding: 10px;">
                                            </div>


                                            <div class="form-group">
                                                <label class="form-label col-md-12">Select Sub-Images</label>
                                                <input type="file" name="subimage_file1[]" accept="image/*"
                                                    class="form-control" multiple
                                                    onchange="get_subimages(this,{{count_rows}});" id="subimage_file1">
                                                <div class="gallery1">
                                                    <script type="text/javascript">
                                                        var imageArray = [];
                                                    </script>

                                                    {{#each sql_subimage}}

                                                    <span id="1_img{{@index}}">
                                                        <img id="blah" src="http://localhost:4000/{{this.subimage}}"
                                                            style="max-width:150px;max-height:150px;margin: auto;padding: 10px;">
                                                        <span class="remove_img_preview"
                                                            onclick="remove_image('1_img{{@index}}',1,'5','http://localhost:4000/{{this.subimage}}')"></span>
                                                        {{!-- ,'http://localhost:4000/{{this.subimage}}' --}}
                                                    </span>
                                                    <script type="text/javascript">

                                                        var f = new File([""], "http://localhost:4000/{{this.subimage}}", {
                                                            type: "image/jpeg",
                                                            lastModified: Date.now()
                                                        })
                                                        var a = Array.from($("#subimage_file1")[0].files);
                                                        a.push(f);
                                                        imageArray = a;
                                                        a = [].slice.call(Array.isArray(a) ? a : arguments)
                                                        for (var c, b = c = a.length, d = !0; b-- && d;) d = a[b] instanceof File
                                                        if (!d) throw new TypeError("expected argument to FileList is File or array of File objects")
                                                        for (b = (new ClipboardEvent("")).clipboardData || new DataTransfer; c--;) b.items.add(a[c]);
                                                        $("#subimage_file1")[0].files = b.files;
                                                    </script>
                                                    {{/each}}
                                                </div>

                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">HSN Code</label>
                                                <input type="text" class="form-control" id="product_hsn"
                                                    name="product_hsn" value="{{sql_product.product_hsn}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Title</label>
                                                <input type="text" class="form-control" id="product_name"
                                                    name="product_name" value="{{sql_product.product_name}}">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Title Short</label>
                                                <input type="text" class="form-control" id="cname" name="cname"
                                                    value="{{sql_product.cname}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Select Brand</label>
                                                <select class="select2-demo form-control" multiple style="width: 100%"
                                                    id="selected_brand" name="selected_brand[]">
                                                    <option value="">Select Brand</option>
                                                    {{#each brand}}
                                                    <option value="{{this._id}}" {{#isInArray ../brandIds
                                                        this._id}}selected{{/isInArray}}>{{this.brand_name}}{{brandIds}}
                                                    </option>
                                                    {{/each}}
                                                    {{!-- {{#if (eq this._id brandIds)}}selected{{/if}} --}}
                                                </select>
                                            </div>

                                            <div class="row">
                                                <div class="form-group col-md-6">
                                                    <label class="form-label"> MRP Price Per Pc</label>
                                                    <input type="number" class="form-control" id="mrp_price"
                                                        name="mrp_price[]" value="{{sql_product.product_mrp_price}}">
                                                </div>



                                                <div class="form-group col-md-6" style="float:right;">
                                                    <label class="form-label">Price Per Pc</label>
                                                    <input type="number" class="form-control" id="product_price"
                                                        name="product_price[]" value="{{sql_product.product_price}}">
                                                </div>
                                            </div>



                                            <div class="row">
                                                <div class="form-group col-md-6" style="float:left;">
                                                    <label class="form-label">PCS</label>
                                                    <input type="number" class="form-control" id="catalog_pcs"
                                                        name="catalog_pcs[]" value="{{sql_product.catalog_pcs}}">
                                                </div>

                                                <div class="form-group col-md-6" style="float:right;">
                                                    <label class="form-label">GST</label>
                                                    <input type="number" class="form-control" id="product_gst"
                                                        name="product_gst[]" value="{{sql_product.product_gst}}">
                                                </div>
                                            </div>


                                            <div class="form-group col-md-6" style="float:right;">
                                                <label class="form-label">Weight (kg)</label>
                                                <input type="number" class="form-control" id="product_weight"
                                                    name="product_weight" value="{{sql_product.product_weight}}">
                                            </div>

                                            <div class="form-group col-md-6">
                                                <label class="form-label">Stitch</label>
                                                <select class="form-control" id="product_stitch" name="product_stitch">
                                                    <option value="">Select Stitch</option>
                                                    <option value="Unstitched" {{#if (eq
                                                        sql_product.product_stitch 'Unstitched' )}}Selected{{/if}}>
                                                        Unstitched</option>
                                                    <option value="Semi Stitched" {{#if (eq
                                                        sql_product.product_stitch 'Semi Stitched' )}}Selected{{/if}}>
                                                        Semi Stitched</option>
                                                    <option value="Full Stitched" {{#if (eq
                                                        sql_product.product_stitch 'Full Stitched' )}}Selected{{/if}}>
                                                        Full Stitched</option>
                                                </select>
                                            </div>

                                            <div class="row">
                                                <div class="form-group col-md-6" style="float:left;">
                                                    <label class="form-label">Video Link</label>
                                                    <input type="text" class="form-control" id="video_link"
                                                        name="video_link[]" value="{{sql_product.video_link}}">
                                                </div>
                                            </div>

                                            <div class="form-group col-md-6">
                                                <label class="form-label">Is Size Available?</label>
                                                <input type="checkbox" id="size_checkbox" name="size_checkbox[]"
                                                    onchange="check_size_available()" {{#isGreaterThan
                                                    sql_size_relation.length 0}}checked{{/isGreaterThan}}>
                                            </div>

                                            <div id="unchecked_size">
                                                <div class="form-group">
                                                    <label class="form-label">Quantity (Stock)</label>
                                                    <input type="number" class="form-control" id="product_quantity"
                                                        name="product_quantity" value="{{sql_product.product_qty}}">
                                                </div>
                                            </div>

                                            <div id="checked_size" style="display:none;">
                                                <div class="form-group">
                                                    <button type="button" class="btn btn-info" onclick="add_size()">Add
                                                        Size</button>
                                                </div>
                                                <div id="show_size" style="display:grid;">
                                                    {{#each sql_size_relation }}
                                                    <div id="sizes{{num}}">
                                                        <div class="row">
                                                            <div class="form-group col-md-4>" style="float:left;">
                                                                <label class="form-label">Size</label>
                                                                <select class="form-control" id="product_size{{num}}"
                                                                    name="product_size1[]">
                                                                    {{#each sizes}}
                                                                    <option value="{{this._id}}" {{#if (eq this._id
                                                                        ../size_id)}} Selected {{/if}}>
                                                                        {{this.size_name}}</option>
                                                                    {{/each}}
                                                                </select>
                                                            </div>

                                                            <div class="form-group col-md-" style="float:left;">
                                                                <label class="form-label">Quantity</label>
                                                                <input type="number" class="form-control"
                                                                    id="product_quantity" name="product_quantity1[]"
                                                                    value="{{this.size_qty}}">
                                                            </div>
                                                            <div class="form-group col-md-" style="float:left;">
                                                                <label class="form-label">Price</label>
                                                                <input type="number" class="form-control"
                                                                    id="size_price" name="size_price1[]"
                                                                    value="{{this.product_price}}">
                                                            </div>
                                                            {{#if (neq num 1)}}
                                                            <div class="form-group col-md-2" style="float:right;">
                                                                <button type="button" class="btn btn-round btn-default"
                                                                    onclick="remove_size({{num}})"><i
                                                                        class="ion ion-md-close align-middle"
                                                                        style="color:red;font-size:20px;"></i></button>
                                                            </div>
                                                            {{/if}}
                                                        </div>
                                                    </div>
                                                    {{/each}}
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="form-group col-md-12">
                                                    <label class="form-label col-md-12"></label>
                                                    <button type="button" class="btn btn-info"
                                                        style="margin: 8px;border-radius: 25px;" id="btn"
                                                        onclick="add_attribute(1)"><i class="fa fa-plus"
                                                            aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;Add
                                                        Atrributes</button>
                                                </div>
                                            </div>
                                            <div id="show_attribute1">
                                                {{sql_attribute}}
                                                {{#each sql_attribute}}

                                                <div class="attributediv" id="attribute1_{{num1}}">
                                                    <div class="row">
                                                        <div class="form-group col-md-1">
                                                            <label class="form-label col-md-12"></label>
                                                            <button type="button" class="btn btn-info"
                                                                style="margin: 8px;border-radius: 25px;background: green;"
                                                                id="btn" onclick="add_attribute(1)"><i
                                                                    class="fa fa-plus" aria-hidden="true"></i></button>
                                                        </div>&nbsp;&nbsp;&nbsp;&nbsp;

                                                        <div class="form-group col-md-4">
                                                            <label class="form-label col-md-12"> Select
                                                                Attribute</label>
                                                            <select id="product_attributea1_{{num1}}"
                                                                name="product_attributea1[{{num1}}][]"
                                                                class="select2-demo form-control abc"
                                                                onchange="myfun(this.value,1,{{num1}})"
                                                                data-placeholder="Choose Sub Category">
                                                                {{#each fetch_attr}}
                                                                <option value="{{this._id}}" {{#if (eq
                                                                    this.attribute_name ../attribute_name)}} Selected
                                                                    {{/if}}> {{this.attribute_name}} </option>
                                                                {{/each}}
                                                            </select>
                                                        </div>

                                                        <div class="form-group col-md-4">
                                                            <label class="form-label col-md-12" data-toggle="modal"
                                                                data-target="#myModal" id="atimepicker"
                                                                data-value="11:45AM" style="display:flex;"> Select Sub
                                                                Attribute <i class="fas fa-plus"
                                                                    id="plusattribute1_{{num1}}"
                                                                    onclick="attributeAdd(1,{{num1}})"
                                                                    style="background: black;font-size: 10px;border-radius: 10px;width: 20px;height: 20px;padding: 5px;color: white;cursor: pointer;display:none;"
                                                                    value=""></i></label>
                                                            <select id="product_subattribute1_{{num1}}"
                                                                name="product_subattribute1[{{num1}}][]"
                                                                class="select2-demo form-control abc1"
                                                                multiple="multiple">
                                                                {{#each fetch_subattribute}}

                                                                <option value="{{this.sub_attribute_name}}" {{#includes1
                                                                    ../attval this.sub_attribute_name}} selected
                                                                    {{/includes1}}>{{this.sub_attribute_name}}
                                                                </option>
                                                                {{!-- {{#includes ../attval this.sub_attribute_name}}
                                                                selected {{/includes}} --}}
                                                                {{/each}}

                                                            </select>
                                                        </div>

                                                        <div class="form-group col-md-1">
                                                            <label class="form-label col-md-12"></label>
                                                            <button
                                                                style="margin: 6px;background: red;border-radius: 25px;"
                                                                type="button" class="btn btn-info"
                                                                onclick="remove_attribute(1,{{num1}})"
                                                                id="btnn1_{{num1}}">
                                                                <i class="fa fa-minus" aria-hidden="true"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                {{/each}}

                                            </div>

                                            <div class="form-group">
                                                <label class="form-label col-md-12">Disable Date</label>
                                                <input type="date" class="form-control" id="disable_date"
                                                    name="disable_date" value="{{disableDate}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Catalog Short Description</label>
                                                <input type="text" class="form-control" id="product_short_description"
                                                    name="product_short_description"
                                                    value="{{sql_product.product_short_description}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Catalog Full Description</label>
                                                <input type="text" class="form-control" id="product_full_description"
                                                    name="product_full_description"
                                                    value="{{sql_product.product_full_description}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Meta Title</label>
                                                <input type="text" class="form-control" id="product_meta_title"
                                                    name="product_meta_title"
                                                    value="{{sql_product.product_meta_title}}">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Meta Keyword</label>
                                                <input type="text" class="form-control" id="product_meta_keyword"
                                                    name="product_meta_keyword"
                                                    value="{{sql_product.product_meta_keyword}}">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Meta Description</label>
                                                <input type="text" class="form-control" id="product_meta_desc"
                                                    name="product_meta_desc"
                                                    value="{{sql_product.product_meta_description}}">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Other Details</label>
                                                <textarea name="editor"
                                                    id="editor1">{{sql_product.other_detail}}</textarea>
                                            </div>
                                            <div class="form-group col-md-12">
                                                <label class="form-label col-md-12">Push to Top</label>
                                                <input type="date" class="form-control" id="product_date"
                                                    name="product_date" value="{{pushtotopDate}}">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label">Notes</label>
                                                <input type="text" class="form-control" id="notes" name="notes"
                                                    value="{{sql_product.note}}">
                                            </div>

                                            <input type="hidden" value="{{totalsize}}" id="total_size"
                                                name="total_size">
                                            <input type="hidden" value="" id="product_id" name="product_id">
                                            <input type="hidden" value="{{add (intval num1) 1}}" id="total_attribute1"
                                                name="total_attribute1">
                                            <input type="hidden" value="{{subtypeIds}}" id="hidden_subcat_id">
                                            <input type="submit" class="btn btn-success" style="float:right;"
                                                value="Update" onclick="submit_product()">
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                {{>admin/footer}}


            </div>


        </div>

    </div>

    <div class="layout-overlay layout-sidenav-toggle"></div>
    </div>

    <script src="/assets/js/pace.js"></script>
    <script src="/assets/js/jquery-3.2.1.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/assets/libs/popper/popper.js"></script>
    <script src="/assets/js/bootstrap.js"></script>
    <script src="/assets/js/sidenav.js"></script>
    <script src="/assets/js/layout-helpers.js"></script>
    <script src="/assets/js/material-ripple.js"></script>


    <script src="/assets/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="/assets/libs/eve/eve.js"></script>
    <script src="/assets/libs/flot/flot.js"></script>
    <script src="/assets/libs/flot/curvedLines.js"></script>
    <script src="/assets/libs/chart-am4/core.js"></script>
    <script src="/assets/libs/chart-am4/charts.js"></script>
    <script src="/assets/libs/chart-am4/animated.js"></script>
    <script src="/assets/libs/raphael/raphael.js"></script>
    <script src="/assets/libs/morris/morris.js"></script>
    <script src="/assets/libs/moment/moment.js"></script>
    <script src="/assets/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js"></script>
    <script src="/assets/libs/datatables/datatables.js"></script>
    <script src="/assets/libs/dropzone/dropzone.js"></script>
    <script src="/assets/libs/bootstrap-select/bootstrap-select.js"></script>
    <script src="/assets/libs/bootstrap-multiselect/bootstrap-multiselect.js"></script>
    <script src="/assets/libs/select2/select2.js"></script>
    <script src="/assets/libs/bootstrap-tagsinput/bootstrap-tagsinput.js"></script>
    <script src="/assets/libs/growl/growl.js"></script>



    <script src="/assets/js/demo.js"></script>
    <script src="/assets/js/analytics.js"></script>
    <script src="/assets/js/pages/forms_selects.js"></script>


    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.print.min.js"></script>
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/buttons/1.4.0/css/buttons.dataTables.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

    <script>
        $(document).ready(function () {
            var subcat_id = $("#hidden_subcat_id").val();
            check_size_available();
            chnagedrop();
        });

        function check_size_available(i) {

            if ($("#size_checkbox").prop("checked") == true) {
                $("#unchecked_size").hide();
                $("#checked_size").show();
            } else if ($("#size_checkbox").prop("checked") == false) {
                $("#unchecked_size").show();
                $("#checked_size").hide();
            }

        }
    </script>

    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <button type="button" class="close" data-dismiss="modal" style="color: black;opacity: unset;"><i
                        class="fa fa-times-circle" aria-hidden="true" style="float: right;"></i></button>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Select Attribute</label>
                        <input type="hidden" id="dynamicid">
                        <select class="form-control" style="width: 100%" id="attribute_name" name="attribute_name">
                            <option value="">Select Attribute</option>
                            {{#each fetch_attr}}
                            <option value="{{this._id}}">{{this.attribute_name}}</option>
                            {{/each}}
                        </select>
                    </div>
                    <div class="form-group">
                        <input type="text" name="sub_attribute_name" id="sub_attribute_name"
                            placeholder="Sub Attribute Name" class="form-control form_control" required="">
                    </div>
                    <p id="subattribute_error" style="font-size:15px;color:red;display:none;"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" style="color: white;background-color: green;"
                        onclick="sub_attribute_add()">Add</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        //Attributes//
        function add_attribute(i) {
            var k = $("#total_attribute" + i).val();
                k= parseInt(k)+1;
            var append_attribute = `<div class="attributediv" id="attribute${i}_${k}">
                            <div class="row">
                                    <div class="form-group col-md-1">
                                    <label class="form-label col-md-12"></label>
                                    <button type="button" class="btn btn-info" style="margin: 8px;border-radius: 25px;background: green;" id="btn" onclick="add_attribute(1)"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                    </div>&nbsp;&nbsp;&nbsp;&nbsp;

                                    <div class="form-group col-md-4">
                                    <label class="form-label col-md-12"> Select Attributes   </label>

                                    <select id="product_attributea${i}_${k}" name="product_attributea${i}[${k}][]" class="select2-demo form-control abc" onchange="myfun(this.value,${i},${k})" data-placeholder="Choose Attribute">
                                    <option value="" disabled selected>Choose Attribute</option>
                                     {{#if fetch_attr.length}}
                                     {{#each fetch_attr}}
                                    <option value="{{this._id}}">{{this.attribute_name}}</option>
                                    {{/each}}
                                    {{/if}}
                                    </select>

                                    </div>

                                    <div class="form-group col-md-4">
                                    <label class="form-label col-md-12" data-toggle="modal" data-target="#myModal" id="atimepicker" data-value="11:45AM" style="display:flex;"> Select Sub Attribute <i class="fas fa-plus" id="plusattribute${i}_${k}" onclick="attributeAdd(${i},${k})" style="background: black;font-size: 10px;border-radius: 10px;width: 20px;height: 20px;padding: 5px;color: white;cursor: pointer;display:none;" value=""></i></label>
                                    <select id="product_subattribute${i}_${k}" name="product_subattribute${i}[${k}][]" class="select2-demo form-control abc1" multiple="multiple">
									</select>
                                    </div>

                                    <div class="form-group col-md-1">
                                    <label class="form-label col-md-12"></label>
                                    <button style="margin: 6px;background: red;border-radius: 25px;" type="button" class="btn btn-info" onclick="remove_attribute(${i},${k})" id="btnn${i}_${k}"><i class="fa fa-minus" aria-hidden="true"></i></button>
                                    </div>
                                </div>
                            </div>`;
            $("#show_attribute" + i).append(append_attribute);
           // k++;
            $("#total_attribute" + i).val(k);
            chnagedrop();
        }

        function chnagedrop() {
            $(".abc option").removeAttr('disabled');
            $(".abc :selected").each(function () {
                var selectedValue = $(this).val();
                $(".abc option[value='" + selectedValue + "']").prop('disabled', true);
            });
            $(".select2-demo").select2();
        }
        $(document).on('change', '.abc', function () {
            chnagedrop()
        })

        function remove_attribute(i, k) {
            var j = $("#total_attribute" + i).val();
            var remove = parseInt(j) - 1;


            $("#attribute" + i + "_" + k).remove();
            if (k == remove) {
                $("#total_attribute" + i).val(remove);
            }
            if (!jQuery("div").hasClass("attributediv")) {
                $("#total_attribute" + i).val(2);
            }
            chnagedrop();
        }
        //End Attributes//
    </script>

    <script>
        CKEDITOR.replace('editor1', {
            filebrowserUploadUrl: 'ckeditor/ck_upload.php',
            filebrowserUploadMethod: 'form'
        });
    </script>

    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#blah')
                        .attr('src', e.target.result);
                };

                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>

    <script>

        function sub_attribute_add() {
            var attribute_name = $("#attribute_name").val();
            var sub_attribute_name = $("#sub_attribute_name").val();
            /* if(attribute_name == "" && sub_attribute_name == "")
            {
                $("#subattribute_error").show();
                $("#subattribute_error").html("ALL FILEDS ARE REQUIRED.");
                setTimeout(function(){ $("#subattribute_error").hide();}, 1000);
            } */
            /* 	else
                { */
            $("#subattribute_error").hide();
            $.ajax({
                type: "POST",
                dataType: "JSON",
                data: {
                    attribute_name: attribute_name,
                    sub_attribute_name: sub_attribute_name
                },
                url: "/subattribute_pop_process",
                success: function (response) {
                    if (response.status == "ok") {
                        var dynamicid = $("#dynamicid").val();
                        $('#product_subattribute' + dynamicid).append('<option value="' + sub_attribute_name + '">' + sub_attribute_name + '</option>');

                        setTimeout(function () {
                            $(".close").click();
                        }, 1000);
                        $("#dynamicid").val("");
                        $("#attribute_name").val("");
                        $("#sub_attribute_name").val("");
                        $('#attribute_name').prop('disabled', false);

                    }
                    if (response.status == "error") {
                        $("#subattribute_error").show();
                        $("#subattribute_error").html(response.message);

                    }
                }
            });
            /* } */
        }

        function myfun(datavalue, i, k) {

            var product_attributea = $("#product_attributea" + i + "_" + k).val();
            if (product_attributea != "") {
                $("#plusattribute" + i + "_" + k).css('display', 'block');
            } else {
                $("#plusattribute" + i + "_" + k).css('display', 'none');
            }

            $.ajax({
                url: '/product_attribute',
                type: 'POST',
                data: {
                    datapost: datavalue
                },

                success: function (result) {
                    $('#product_subattribute' + i + '_' + k + '').html(result);
                }
            });
        }

        function remove_size(k) {
            var j = $("#total_size").val();
            console.log("j", j);
            console.log("sughs" + parseInt(j))
            var remove = parseInt(j) - 1;

            $("#sizes" + remove).remove();
            $("#total_size").val(remove);

        }

        function check_size_available(i) {

            if ($("#size_checkbox").prop("checked") == true) {
                $("#unchecked_size").hide();
                $("#checked_size").show();
            }
            else if ($("#size_checkbox").prop("checked") == false) {
                $("#unchecked_size").show();
                $("#checked_size").hide();
            }

        }

        function add_size() {
            var k = $("#total_size").val();
            var product_price = $("#product_price" + k).val();
            var append_size = `<div id="sizes${k}"><div class="row"><div class="form-group col-md-3"><label class="form-label">Size</label><select class="form-control" id="product_size${k}" name="product_size1[]">
				 {{#each size}}<option value="{{this._id}}"> {{this.size_name}}</option>{{/each}}
                 </select></div><div class="form-group col-md-3" style="float:right;"><label class="form-label">Quantity</label><input type="number" class="form-control" id="product_quantity${k}" name="product_quantity1[]"></div><div class="form-group col-md-4"><label class="form-label">Price</label><input type="number" class="form-control" id="size_price${k}" name="size_price1[]" value="${product_price}"></div><div class="form-group col-md-2"><button type="button" class="btn btn-round btn-default" onclick="remove_size('${k}')"><i class="ion ion-md-close align-middle" style="color:red;font-size:20px;"></i></button></div></div></div>`;

            $("#show_size").append(append_size);
            k++;
            $("#total_size").val(k);
        }

    </script>

    <script>

        function subcat_get(subtypeIds) {

            var cat_id = $("#selected_cat").val();

            //  var subcat_id = $("#get_subcat").val();

            $(".extrablock").hide();
            var selectedcat = cat_id;

            var selctedkir = ['6', '3', '20', '10', '11'];
            var selctedwesnight = ['921', '923'];
            var selctedaccess = ['922'];
            var selctedsarr = ['5'];
            var selctedle = ['7'];
            let isFounded = selctedkir.some(ai => selectedcat.includes(ai));
            if (isFounded) {
                $(".kurtiesblock").show();
            }
            let isFounded_1 = selctedwesnight.some(ai => selectedcat.includes(ai));
            if (isFounded_1) {
                $(".western_night_wearblock").show();
            }
            let isFounded_2 = selctedaccess.some(ai => selectedcat.includes(ai));
            if (isFounded_2) {
                $(".accessories_block").show();
            }
            let isFounded1 = selctedsarr.some(ai => selectedcat.includes(ai));
            if (isFounded1) {
                $(".sareesblock").show();
            }
            let isFounded2 = selctedle.some(ai => selectedcat.includes(ai));
            if (isFounded2) {
                $(".lehengablock").show();
            }
            $.ajax({
                type: "POST",
                url: "/get_subcat_from_cat/" + cat_id,
                data: {
                    subtypeIds: subtypeIds,
                    protype: 'edit'
                },

                success: function (response) {
                    //alert(response);
                    var responseOpt = '';
                    var subtypeIds = response.subtypeIds;

                    var result = response.result;

                    /*  for (var prop in response) {
                          var selectedField = '';
                          console.log("response[prop]._id",response[prop]._id);
                          var selectedField = subtypeIds.includes(response[prop]._id);
                          console.log("selectedField",selectedField)

                          // if(subtypeIds.includes(response[prop]._id)){
                         //     selectedField = 'selected';
                         // }

                          responseOpt += `<option value='${response[prop]._id}'  ${selectedField}>${response[prop].subcategory_name}</option>`
                      } */

                    response.result.forEach(function (subcat) {
                        var selectedField = '';

                        if (subtypeIds.includes(subcat._id.toString())) {
                            /* subtypeIds.includes(subcat._id.toString()) */

                            selectedField = 'selected';
                        }

                        responseOpt += `<option value='${subcat._id}' ${selectedField}>${subcat.subcategory_name}</option>`;
                    });

                    document.getElementById("get_subcat").innerHTML = responseOpt;
                }
            });
        }
    </script>

    <script>

        function attributeAdd(i, k) {

            var selected_attr = $("#product_attributea" + i + "_" + k + " option[disabled]:selected").val();
            $("#attribute_name").val(selected_attr);
            $('#attribute_name').prop('disabled', true);
            $("#dynamicid").val(i + "_" + k);
            //    $('#modal').modal('show');
        }

        var idsray = [];

        function imagesPreview(input, placeToInsertImagePreview, productcount) {
            if (input.files && imageArray.length) {
                var a = Array.from(input.files);
                var b = imageArray;
                var c = a.concat(b);
                input.files = new FileListItem(c);
                imageArray = c;
            } else if (imageArray.length) {
                var a = new FileListItem(imageArray);
                input.files = new FileListItem(imageArray);
                imageArray = a;
            }
            if (input.files) {
                var filesAmount = input.files.length;
                imageArray = Array.from(input.files);
                var j = 0;
                for (i = 0; i < filesAmount; i++) {
                    var currFile = imageArray[i];
                    var reader = new FileReader();
                    reader.onload = (function (theFile) {
                        return function (event) {
                            if (event.loaded > 0) {
                                j++;
                                //var id=productcount+'_img'+j;
                                var fileName = theFile.name;
                                var id = j + '_img' + productcount;

                                //console.log("hii=" + fileName);

                                if (idsray.includes(id)) {
                                } else {
                                    idsray.push(id);
                                    $($.parseHTML('<span id="' + id + '"><img   style="max-height:100px;max-width:100px;margin:5px;cursor:pointer;" src="' + event.target.result + '"><span class="remove_img_preview" onclick="remove_image(\'' + id + '\',' + productcount + ',' + j + ',\'' + fileName + '\')"></span></span>')).appendTo(placeToInsertImagePreview);
                                }
                            }
                        };
                    })(currFile);
                    reader.readAsDataURL(input.files[i]);

                }
            }
        };

        function remove_image1(id, i, j, img) {
            // console.log("JJJ");
            // console.log(j);
            //console.log(i);
            //$('#subimage_file'+i).val(delete_id.join(','));
            /////console.log(delete_id);*/
            var a = Array.from($("#subimage_file1")[0].files);
            /*console.log(a);
             j = j - 1;
            if (j > a.length - 1) {
              j = a.length - 1;
              console.log("afterJ" + j)
            }

            var imgName = img.split('/').pop(); */

            a = a.filter(function (elem) {
                return elem.name != img;
            });

            imageArray = a;
            // console.log(a);
            $("#subimage_file1")[0].files = new FileListItem(a);
            // console.log(id);
            $("#" + id).remove();
        }
        function remove_image(id, i, j, img) {
            /* var a = Array.from($("#subimage_file1")[0].files);
                  console.log(a);
                  a = a.filter(function(elem) {
                      return elem.name != img;
                  });
                  imageArray = a;
                  $("#subimage_file1")[0].files = new FileListItem(a);
                  $("#" + id).remove(); */
            var a = Array.from($("#subimage_file1")[0].files);
            console.log(a);
            // console.log(img);
            a = a.filter(function (elem) {
                console.log($.trim(img), "-elem.name-", elem.name);
                return elem.name != $.trim(img);
            });
            imageArray = a;
            //  console.log("imageArray-",imageArray);
            $("#subimage_file1")[0].files = new FileListItem(a);
            $("#" + id).remove();
        }

        function FileListItem(a) {
            a = [].slice.call(Array.isArray(a) ? a : arguments)
            for (var c, b = c = a.length, d = !0; b-- && d;) d = a[b] instanceof File
            if (!d) throw new TypeError("expected argument to FileList is File or array of File objects")
            for (b = (new ClipboardEvent("")).clipboardData || new DataTransfer; c--;) b.items.add(a[c])
            return b.files
        }

        function get_subimages(input, i) {
            // console.log(i);
            //var a = Array.from($("#subimage_file"+i)[0].files);
            $('div.gallery' + i).html("");
            imagesPreview(input, 'div.gallery1', i);
        };

        function addInImageArray() {
            var a = Array.from($("#subimage_file1")[0].files);
            console.log(a);
            imageArray = a;
        }


    </script>

    <script>
        function submit_product() {

            var total = $("#total").val();
            var image_file = new Array();
            var subimage_file1 = new Array();
            var product_name = new Array();
            var cname = new Array();
            var product_sku = new Array();
            var product_hsn = new Array();
            var product_regular_price = new Array();
            var product_sale_price = new Array();
            var product_quantity = new Array();
            var product_weight = new Array();
            var product_gst = new Array();
            var product_stitch = new Array();
            var selected_size = new Array();
            var selected_color = new Array();
            var product_short_description = new Array();
            var product_full_description = new Array();
            var product_status = new Array();
            var product_meta_title = new Array();
            var product_meta_keyword = new Array();
            var product_meta_desc = new Array();




            var selected_cat = $("#selected_cat").val();

            if (selected_cat == "") {
                $.growl.error({
                    message: 'Please Select Catalog Name',
                    location: 'tr'
                });
                return false;
            }


            if ($("#product_sku").val() == "") {

                $.growl.error({
                    message: 'Please Insert Product Sku',
                    location: 'tr'
                });

                return false;

            }


            if ($("#product_name").val() == "") {

                $.growl.error({
                    message: 'Please Insert Name Of Product ',
                    location: 'tr'
                });

                return false;

            }
            if ($("#cname").val() == "") {

                $.growl.error({
                    message: 'Please Insert Short Name Of Product ',
                    location: 'tr'
                });
                return false;
            }


            if ($("#product_sale_price").val() == "") {
                $.growl.error({
                    message: 'Please Insert Sale Price Of Product ',
                    location: 'tr'
                });
                return false;
            }

            if ($("#product_weight").val() == "") {
                $.growl.error({
                    message: 'Please Insert Weight Of Product ',
                    location: 'tr'
                });
                return false;
            }

            if ($("#product_gst").val() == "") {
                $.growl.error({
                    message: 'Please Insert GST Of Product ',
                    location: 'tr'
                });
                return false;
            }

            if ($("#product_stitch").val() == "") {
                $.growl.error({
                    message: 'Please Select Stitch Of Product ',
                    location: 'tr'
                });
                return false;
            }



            var method = "update";
            var product_name = $("#product_name").val();
            var product_sku = $("#product_sku").val();
            var product_id = $("#product_id").val();
            $.ajax({

                type: "POST",
                data: {
                    product_sku: product_sku,
                    product_name: product_name,
                    method: method,
                    product_id: product_id
                },
                url: "/check_repeat_product",
                success: function (response) {
                    if (response == "ok") {
                        $("form").submit();
                    } else {
                        $.growl.error({
                            message: 'Product Name Or Product Sku  Already Exists',
                            location: 'tr'
                        });
                        return false;
                    }
                }
            });

            $(".abc option").removeAttr('disabled');

        }
        $(document).ready(function () {

            var subtypeIds = $("#hidden_subcat_id").val();
            subcat_get(subtypeIds);
            check_size_available();

        });
    </script>

</body>


</html>