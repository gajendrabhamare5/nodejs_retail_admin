<!DOCTYPE html>

<html lang="en" class="default-style layout-fixed layout-navbar-fixed">

<head>
    <title>Subcategory | title</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description"
        content="Empire Bootstrap admin template made using Bootstrap 4, it has tons of ready made feature, UI components, pages which completely fulfills any dashboard needs." />
    <meta name="keywords"
        content="Empire, bootstrap admin template, bootstrap admin panel, bootstrap 4 admin template, admin template">
    <meta name="author" content="Srthemesvilla" />
    <link rel="icon" type="image/x-icon" href="<?php echo $fav_icon ?>">

    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
    {{!-- <script src="https://cdn.ckeditor.com/4.12.1/standard/ckeditor.js"></script> --}}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ckeditor/4.9.2/ckeditor.js"></script>
    <!-- Icon fonts -->
    <link rel="stylesheet" href="/assets/fonts/fontawesome.css">
    <link rel="stylesheet" href="/assets/fonts/ionicons.css">
    <link rel="stylesheet" href="/assets/fonts/linearicons.css">
    <link rel="stylesheet" href="/assets/fonts/open-iconic.css">
    <link rel="stylesheet" href="/assets/fonts/pe-icon-7-stroke.css">
    <link rel="stylesheet" href="/assets/fonts/feather.css">

    <!-- Core stylesheets -->
    <link rel="stylesheet" href="/assets/css/bootstrap-material.css">
    <link rel="stylesheet" href="/assets/css/shreerang-material.css">
    <link rel="stylesheet" href="/assets/css/uikit.css">

    <!-- Libs -->
    <link rel="stylesheet" href="/assets/libs/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="/assets/libs/flot/flot.css">
    <link rel="stylesheet" href="/assets/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css">
    <link rel="stylesheet" href="/assets/libs/datatables/datatables.css">
</head>

<body>
    <!-- [ Preloader ] Start -->
    <div class="page-loader">
        <div class="bg-primary"></div>
    </div>
    <!-- [ Preloader ] End -->

    <!-- [ Layout wrapper ] Start -->
    <div class="layout-wrapper layout-2">
        <div class="layout-inner">
            <!-- [ Layout sidenav ] Start -->
            {{>admin/sidebar}}
            <!-- [ Layout sidenav ] End -->
            <!-- [ Layout container ] Start -->
            <div class="layout-container">
                <!-- [ Layout navbar ( Header ) ] Start -->
                {{>admin/header}}
                <!-- [ Layout navbar ( Header ) ] End -->

                <!-- [ Layout content ] Start -->
                <div class="layout-content">

                    <!-- [ content ] Start -->
                    <div class="container-fluid flex-grow-1 container-p-y">
                        <h4 class="font-weight-bold py-3 mb-0">Edit Subcategory</h4>
                        <div class="text-muted small mt-0 mb-4 d-block breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/index"><i class="feather icon-home"></i></a></li>
                                <li class="breadcrumb-item ">Subcategory</li>
                                <li class="breadcrumb-item active">Edit Subcategory</li>
                            </ol>
                        </div>

                        <div class="card mb-4 col-md-12" style="float:left;margin-right:40px;">
                            <form action="/retail_admin/subcategory_edit/{{subcategory._id}}" method="post" enctype="multipart/form-data">
                            <h6 class="card-header">Edit Subcategory</h6>
                            <div class="card-body">

                                <div class="form-group">
                                    <label class="form-label">Select Category</label>
                                    <select class="custom-select" id="selected_cat" name="selected_cat">
                                        <option value="">Select Category</option>
                                        {{#each category}}
                                        <option value="{{this._id}}" {{#if (eq this._id ../subcategory.category_id)}} selected {{/if}}>
                                        {{this.category_name}}</option>
                                        {{/each}}
                                    </select>
                                </div>
                                    {{!-- {{#each subcategory}} --}}
                                <div class="form-group">
                                    <label class="form-label">Select Image</label>
                                    <input type="file" name="image_file" accept="image/*" class="form-control"
                                        onchange="readURL(this);" id="image_file">
                                    <img id="blah" src="http://localhost:4000/{{subcategory.subcategory_image}}"
                                        style="max-width:150px;max-height:150px;margin: auto;border: 3px solid #73AD21;padding: 10px;">
                                </div>
                                <script>
                                    function readURL(input) {
                                        if (input.files && input.files[0]) {
                                            var reader = new FileReader();

                                            reader.onload = function (e) {
                                                $('#blah')
                                                    .attr('src', e.target.result);
                                            };

                                            reader.readAsDataURL(input.files[0]);
                                        }
                                    }
                                </script>
                                {{!-- <div class="form-group">
                                    <label class="form-label col-md-4">
                                        <input type="radio" name="subcat_type" value="Parant"
                                            onclick="myFunction('Parant')"> Parant
                                    </label>
                                    <label class="form-label col-md-4">
                                        <input type="radio" name="subcat_type" value="Child"
                                            onclick="myFunction('Child')" checked> Child
                                    </label>
                                </div> --}}

                                <div class="form-group">
                                    <label class="form-label">Subcategory Name</label>
                                    <input type="text" class="form-control" id="subcat_name" name="subcat_name" autofocus
                                        value="{{subcategory.subcategory_name}}">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">SubCategory Slug</label>
                                    <input type="text" class="form-control" id="subcat_slug" name="subcat_slug"
                                        value="{{subcategory.subcategory_seo_url}}">
                                </div>

                             {{!--    <div class="form-group">
                                    <label class="form-label">SubCategory Mobile Number</label>
                                    <input type="text" class="form-control" id="subcat_mobile"
                                        value="<?php echo $f1['subcat_mobile']; ?>">
                                </div> --}}

                                <div class="form-group">
                                    <label class="form-label">Meta Title</label>
                                    <input type="text" class="form-control" id="subcat_meta_title" name="subcat_meta_title"
                                        value="{{subcategory.subcategory_meta_title}}">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Meta Keyword</label>
                                    <input type="text" class="form-control" id="subcat_meta_keyword" name="subcat_meta_keyword"
                                        value="{{subcategory.subcategory_meta_keyword}}">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Meta Description</label>
                                    <input type="text" class="form-control" id="subcat_meta_desc" name="subcat_meta_desc"
                                        value="{{subcategory.subcategory_meta_description}}">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">SubCategory content</label>
                                    <textarea class="ckeditor" name="content"
                                        id="editor1">{{subcategory.other_details}}</textarea>
                                    <!-- <small class="form-text text-muted" id="error" style="display:none;color:red !important;"></small> -->
                                </div>


                                <input type="hidden" id="subcat_id" value="{{this._id}}">
                                 {{!-- {{/each}} --}}
                                <small class="form-text text-muted" id="error"
                                    style="display:none;color:red !important;margin-bottom:10px;"></small>
                                <button type="submit" id="add_subcat" class="btn btn-primary" >Update</button>
                            </div>
                            </form>
                        </div>


                    </div>
                    <!-- [ content ] End -->

                    <!-- [ Layout footer ] Start -->
                    {{>admin/footer}}
                    <!-- [ Layout footer ] End -->

                </div>
                <!-- [ Layout content ] Start -->

            </div>
            <!-- [ Layout container ] End -->
        </div>
        <!-- Overlay -->
        <div class="layout-overlay layout-sidenav-toggle"></div>
    </div>
    <!-- [ Layout wrapper] End -->

    <!-- Core scripts -->
    <script src="/assets/js/pace.js"></script>
    <script src="/assets/js/jquery-3.2.1.min.js"></script><!-- tables not work in jquery-3.3.1 js -->
    <script src="/assets/libs/popper/popper.js"></script>
    <script src="/assets/js/bootstrap.js"></script>
    <script src="/assets/js/sidenav.js"></script>
    <script src="/assets/js/layout-helpers.js"></script>
    <script src="/assets/js/material-ripple.js"></script>

    <!-- Libs -->
    <script src="/assets/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="/assets/libs/eve/eve.js"></script>
    <script src="/assets/libs/flot/flot.js"></script>
    <script src="/assets/libs/flot/curvedLines.js"></script>
    <script src="/assets/libs/chart-am4/core.js"></script>
    <script src="/assets/libs/chart-am4/charts.js"></script>
    <script src="/assets/libs/chart-am4/animated.js"></script>
    <script src="/assets/libs/raphael/raphael.js"></script>
    <script src="/assets/libs/morris/morris.js"></script>
    <script src="/assets/libs/moment/moment.js"></script>
    <script src="/assets/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js"></script>
    <script src="/assets/libs/datatables/datatables.js"></script>

    <!-- Demo -->
    <script src="/assets/js/demo.js"></script>
    <script src="/assets/js/analytics.js"></script>

    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.print.min.js"></script>
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/buttons/1.4.0/css/buttons.dataTables.min.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/pdfmake.min.js"></script>
    {{!-- <script>
        function get_subcat1() {
            var cat_id = $("#selected_cat").val();
            var subcat_id = $("#get_subcat").val();
            $(".extrablock").hide();
            var selectedcat = cat_id;
            console.log(selectedcat);
            var selctedkir = ['6', '3', '20', '10', '11'];
            var selctedwesnight = ['921', '923'];
            var selctedaccess = ['922'];
            var selctedsarr = ['5'];
            var selctedle = ['7'];
            let isFounded = selctedkir.some(ai => selectedcat.includes(ai));
            if (isFounded) {
                $(".kurtiesblock").show();
            }
            let isFounded_1 = selctedwesnight.some(ai => selectedcat.includes(ai));
            if (isFounded_1) {
                $(".western_night_wearblock").show();
            }
            let isFounded_2 = selctedaccess.some(ai => selectedcat.includes(ai));
            if (isFounded_2) {
                $(".accessories_block").show();
            }
            let isFounded1 = selctedsarr.some(ai => selectedcat.includes(ai));
            if (isFounded1) {
                $(".sareesblock").show();
            }
            let isFounded2 = selctedle.some(ai => selectedcat.includes(ai));
            if (isFounded2) {
                $(".lehengablock").show();
            }

            console.log(isFounded1);
            $.ajax({
                type: "POST",
                data: { subcat_id: subcat_id },
                url: "ajaxfiles/get_subcat_from_cat.php?cat_id=" + cat_id,
                success: function (response) {
                    //alert(response);
                    $("#get_subcat").html(response);
                }
            });
        }
    </script> --}}
    <script>
        function myFunction(val) {
            $("#demochek1").hide();
            if (val == "Parant") {
                $("#demochek1").show();
            }
        }


        CKEDITOR.replace('editor1', {
            filebrowserUploadUrl: 'ckeditor/ck_upload.php',
            filebrowserUploadMethod: 'form'
        });


        /* function update_subcategory() {
            var cat_id = $("#selected_cat").val();
            var subcontent = CKEDITOR.instances['editor1'].getData();
            var image_file = $('#image_file').prop('files')[0];
            var subcat_id = $("#subcat_id").val();
            var subcat_type = $("input[type='radio'][name='subcat_type']:checked").val();
            var selected_subcat = $("#selected_subcat").val();
            var subcat_name = $("#subcat_name").val();
            var subcat_meta_title = $("#subcat_meta_title").val();
            var subcat_meta_keyword = $("#subcat_meta_keyword").val();
            var subcat_meta_desc = $("#subcat_meta_desc").val();
            var subcat_slug = $("#subcat_slug").val();
            var subcat_mobile = $("#subcat_mobile").val();
            var form_data = new FormData();
            form_data.append('image_file', image_file);
            form_data.append('subcat_id', subcat_id);
            form_data.append('cat_id', cat_id);
            form_data.append('subcat_name', subcat_name);
            form_data.append('subcat_meta_title', subcat_meta_title);
            form_data.append('subcat_meta_keyword', subcat_meta_keyword);
            form_data.append('subcat_meta_desc', subcat_meta_desc);
            form_data.append('subcat_type', subcat_type);
            form_data.append('content', subcontent);
            form_data.append('subcat_slug', subcat_slug);
            form_data.append('subcat_mobile', subcat_mobile);

            if (subcat_type == "Parant") {
                form_data.append('selected_subcat', selected_subcat);

            }

            if (cat_id == "") {
                $("#error").html("Select Category Name.");
                $("#error").show();
            } else if (subcat_name == "") {
                $("#error").html("Enter Subcategory Name.");
                $("#error").show();
            } else {
                $("#error").hide();
                $("#add_subcat").attr("disabled", "disabled");

                $.ajax({

                    type: "POST",
                    data: form_data,
                    dataType: 'text',
                    contentType: false,
                    cache: false,
                    processData: false,
                    url: "ajaxfiles/subcategory_edit_process.php",
                    //data: {subcat_id:subcat_id,cat_id:cat_id,subcat_name:subcat_name,subcat_meta_title:subcat_meta_title,subcat_meta_keyword:subcat_meta_keyword,subcat_meta_desc:subcat_meta_desc},
                    success: function (response) {
                        if (response == "ok") {
                            location.href = "subcategory_add.php";
                        }
                        else if (response == "image_error") {
                            alert("Please select image with only  JPG,PNG ,JPEG extension.");
                        }
                        else if (response == "error") {
                            alert("Subcategory name already exist");
                        }
                        else if (response == "errorcat") {
                            alert("Category name already exist");
                        }
                    }

                });
            }
        } */


    </script>

</body>


</html>