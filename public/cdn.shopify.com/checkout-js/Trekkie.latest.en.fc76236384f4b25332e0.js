(self.webpackJsonp=self.webpackJsonp||[]).push([["Trekkie"],{dlzA:function(e,t,i){"use strict";i.r(t),i.d(t,"TrekkieWrapper",(function(){return w}));var a=i("FdF9"),n=i("F7w1"),r=i("6MI/"),o=i("c+Z2"),c=i("hgiX"),l=i("3Dp7");class s extends Error{constructor(){super(...arguments),this.name="TrekkieError"}}class u{get trekkie(){var e;return null==(e=this.analyticsWindow)?void 0:e.trekkie}set trekkie(e){if(!this.analyticsWindow)throw new s("AnalyticsWindow is not set.");this.analyticsWindow.trekkie=e}get shopifyAnalytics(){return this.analyticsWindow.ShopifyAnalytics}set shopifyAnalytics(e){if(!this.analyticsWindow)throw new s("AnalyticsWindow is not set.");this.analyticsWindow.ShopifyAnalytics=e}constructor(e,t){var i,a,n=this;let{shop:r,checkoutToken:s="",locale:u,analyticsConfig:d,sourceUrl:p,themeId:k,themeCityHash:h,monorail:b,isGdprSuppressAnalyticsEnforced:y,s2s:v,monorailRegion:f}=e;var m,g,A;if(this.libraryLoaded=!1,this.analyticsWindow=void 0,this.trekkieLoadedCallback=void 0,this.trekkieLoadedCallback=t,this.analyticsWindow=window,this.trekkie=(null==(i=this.analyticsWindow.ShopifyAnalytics)?void 0:i.lib)||this.analyticsWindow.trekkie||[],null!=(a=this.trekkie)&&a.integrations)return this.libraryLoaded=!0,void this.trekkieLoadedCallback(null==(m=this.analyticsWindow)||null==(g=m.ShopifyAnalytics)||null==(A=g.lib)?void 0:A.trekkie);const C=e=>function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return i.unshift(e),n.trekkie.push(i),n.trekkie};this.trekkie.track=C("track"),this.trekkie.page=C("page"),this.trekkie.ready=C("ready");const O=parseInt(Object(c.a)(r.id),10);this.trekkie.ready(()=>{var e,t,i;this.libraryLoaded||(this.libraryLoaded=!0,this.shopifyAnalytics={...this.shopifyAnalytics,lib:this.trekkie},this.trekkieLoadedCallback(null==(e=this.analyticsWindow)||null==(t=e.ShopifyAnalytics)||null==(i=t.lib)?void 0:i.trekkie))}),this.trekkie.load=e=>{var t;this.trekkie.config=e;const i=document.getElementsByTagName("script")[0],a=document.createElement("script");a.type="text/javascript",a.onerror=function(){var e;const t=document.createElement("script");t.type="text/javascript",t.onerror=function(){const e={schemaId:"trekkie_checkout_load_errors/1.1",payload:{appName:"checkout",shopId:O,themeId:k,contextUrl:window.location.href,sourceUrl:p}};b.record(e)},t.async=!0,t.src=p,null==(e=i.parentNode)||e.insertBefore(t,i)},a.async=!0,a.src=p,null==(t=i.parentNode)||t.insertBefore(a,i)};const I={appName:"checkout",development:Object(l.b)()||!1,defaultAttributes:{shopId:O,isMerchantRequest:!!Object(o.b)("_ab")||null,themeId:k,themeCityHash:h,contentLanguage:u,currency:r.currencyCode,checkoutToken:s},isServerSideCookieWritingEnabled:!0,suppressAnalyticsWhenGdprEnforced:y};f&&(I.monorailRegion=f),this.trekkie.load({Trekkie:I,...d,"Session Attribution":{},S2S:v})}page(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;null==(e=this.trekkie)||e.page(t,i,a)}track(e,t,i){var a;null==(a=this.trekkie)||a.track(e,t,i)}}let d;!function(e){e.Facebook="FACEBOOK",e.Pinterest="PINTEREST",e.Snapchat="SNAPCHAT",e.TikTok="TIK_TOK",e.GoogleTagManager="GOOGLE_TAG_MANAGER"}(d||(d={}));var p=i("BGKX"),k=i("re6F"),h=i("bgyr"),b=i("+Dcn"),y=i("N6z0"),v=i("AlHd"),f=i("bPU2"),m=i("SWt0"),g=i("x6h/"),A=i("SSp2"),C=i("lpSf"),O=i("k/ey"),I=i("X1v3");function w(){var e,t,i;const o=Object(r.b)(),s=Object(h.c)(),w=s.checkoutSessionIdentifier||s.sourceId,j=Object(p.a)(),S=Object(n.a)(),T=Object(k.a)();let P=void 0===(null==(e=o.theme)?void 0:e.id)||null===(null==(t=o.theme)?void 0:t.id)?void 0:parseInt(o.theme.id,10);P&&P>Number.MAX_SAFE_INTEGER&&(P=void 0);const x=null==(i=o.theme)?void 0:i.cityhash,E=Object(b.r)(),_=Object(y.f)(),N=Object(g.a)(),W=Object(A.a)("api-client-id"),[G,L]=Object(v.b)([f.M,f.N]),F=Object(a.useMemo)(()=>{if(Object(l.c)())return{};const e=o.analyticsAccount?{"Google Analytics":{trackingId:o.analyticsAccount,domain:"auto",siteSpeedSampleRate:"10",enhancedEcommerce:o.enhancedEcommerceEnabled,doubleClick:!0,includeSearch:!0}}:{};return(o.trackingPixels||[]).reduce((e,t)=>{let{pixelType:i,pixelId:a,pixelConfig:n}=t;const r=function(e){switch(e){case d.Pinterest:return"Pinterest Pixel";case d.Snapchat:return"Snap Pixel";case d.TikTok:return"TikTok Pixel";case d.Facebook:case d.GoogleTagManager:return;default:Object(m.b)(e)}}(i);switch(i){case d.GoogleTagManager:{const t=n||{};e["Google Gtag Pixel"]={conversionId:a,eventLabels:(null==t?void 0:t.gtag_events)||[],targetCountry:(null==t?void 0:t.target_country)||"US"}}break;case d.Facebook:e["Facebook Pixel"]||(e["Facebook Pixel"]={pixelIds:[],agent:"plshopify1.2"}),e["Facebook Pixel"].pixelIds.push(a);break;case d.Pinterest:e["Pinterest Pixel"]={pixelId:a};break;case d.Snapchat:e["Snap Pixel"]={pixelId:a};break;case d.TikTok:e["TikTok Pixel"]={pixelId:a};break;default:if(!r)return T.notify(new I.a(`Shop has unknown pixelType "${i}".`)),e;e[r]={pixelId:a}}return e},e)},[o.trackingPixels,o.analyticsAccount,o.enhancedEcommerceEnabled,T]),M=Object(O.b)(),R=Object(a.useCallback)(e=>{null!=e&&M.value.defaultAttributes!==e.defaultAttributes?M.setValue({defaultAttributes:e.defaultAttributes}):null==e&&T.notify(new I.a("Trekkie is not available"))},[T,M]),U=Object(a.useMemo)(()=>{var e;const t=null===x?void 0:x,i=_.read(E.current.fields.buyerIdentity).value,a={shop:o,checkoutToken:w,locale:S,analyticsConfig:F,sourceUrl:"https://cdn.shopify.com/s/trekkie.storefront.min.js",themeId:P,themeCityHash:t,monorail:j,s2s:{facebookAppPixelId:o.facebookAppPixelId,facebookCapiEnabled:o.facebookCapiEnabled,source:"trekkie-checkout-one",customerId:H(null==i||null==(e=i.customerProfile)?void 0:e.id),cartApiClientId:W},isGdprSuppressAnalyticsEnforced:G};return L&&(a.monorailRegion="shop_domain"),function(e,t){return new u(e,t)}(a,R)},[o,w,S,F,P,x,j,G,R,E,_,L,W]),B=Object(a.useCallback)(e=>{const{title:t,page:i}=function(e){switch(e){case"/":case"/information":return{title:"Checkout - Contact Information",page:"/checkout/contact_information"};case"/shipping":return{title:"Checkout - Shipping",page:"/checkout/shipping"};case"/payment":return{title:"Checkout - Payment",page:"/checkout/payment"};case"/review":return{title:"Checkout - Review",page:"/checkout/review"};case"/processing":return{title:"Checkout - Processing",page:"/checkout/processing"};case"/thank-you":return{title:"Checkout - Receipt",page:"/checkout/thank_you"};case"/stock-problems":return{title:"Checkout - Stock problems",page:"/checkout/stock_problems"};case"/error":return{title:"Checkout - Error",page:"/checkout/error"};case"/no-address-location":return{title:"Checkout - No Address Location",page:"/checkout/no_address_location"};case"/shoppay_login":return{title:"ShopPay - Login",page:"/shop.app/pay/login"};case"/shoppay":return{title:"ShopPay - Payment",page:"/shop.app/pay/payment"};default:return{title:null,page:null}}}(e);t&&i&&U.page(t,{path:i})},[U]);function H(e){return e?parseInt(Object(c.a)(e),10):void 0}const z=Object(a.useMemo)(()=>{var e;const t=_.read(E.current.fields.merchandiseLines).value;return null==t||null==(e=t.lines)?void 0:e.map(e=>{var t;return{variantId:H(e.variantId),productId:H(e.productId),productGid:e.productId,category:e.productType,name:e.title,price:null==(t=e.itemPrice)?void 0:t.amount,quantity:e.quantity,brand:e.vendor,variant:e.subtitle}})},[_,E]),K=Object(a.useCallback)(()=>{const e=_.read(E.current.fields.subtotal).value,t={step:1,products:z,currency:null==e?void 0:e.currencyCode,revenue:null==e?void 0:e.amount};U.track("Started Order",t)},[U,_,E,z]),X=Object(a.useCallback)(()=>{var e,t,i;if(!N||N.classicThankYouPageUrl)return;const a=N.purchaseOrder.billingAddress,n=_.read(E.current.fields.buyerIdentity).value,r=null==n?void 0:n.customerProfile;let o=null==r?void 0:r.firstName,c=null==r?void 0:r.lastName;c||(o=null==a?void 0:a.firstName,c=null==a?void 0:a.lastName);const l=_.read(E.current.fields.total).value,s=_.read(E.current.fields.contactInfo).value;U.track("Completed Order",{customerEventData:{customer:{firstName:o,lastName:c,emailAddress:null!=(e=null==r?void 0:r.email)?e:null==s?void 0:s.email,phoneNumber:null!=(t=null==r?void 0:r.phone)?t:null==s?void 0:s.phone},address:{city:null==a?void 0:a.city,province:null==a?void 0:a.zoneCode,country:null==a?void 0:a.countryCode,zip:null==a?void 0:a.postalCode}},products:z,total_value:null!=(i=null==l?void 0:l.amount)?i:0,currency:null==l?void 0:l.currencyCode})},[U,_,E,z,N]),q=Object(a.useCallback)(()=>{const e=_.read(E.current.fields.total).value;U.track("Added Payment",{currency:null==e?void 0:e.currencyCode,total:null==e?void 0:e.amount})},[U,_,E]);return Object(C.b)(Object(a.useCallback)(e=>{M.value.defaultAttributes&&"page_view"===e.type&&B(e.url)},[M,B])),Object(C.b)(Object(a.useCallback)(e=>{M.value.defaultAttributes&&"initiate_checkout"===e.type&&K()},[M,K])),Object(C.b)(Object(a.useCallback)(e=>{M.value.defaultAttributes&&"complete_checkout"===e.type&&X()},[M,X])),Object(C.b)(Object(a.useCallback)(e=>{M.value.defaultAttributes&&"add_payment_info"===e.type&&q()},[M,q])),null}}}]);